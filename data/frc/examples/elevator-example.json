{
  "title": "Elevator Example",
  "sections": [
    {
      "type": "text",
      "title": "Overview",
      "content": "Elevators require <strong>Position Control</strong>. Unlike intakes (speed), elevators must move to precise heights and hold them against gravity. We use PID control with Feedforward and Motion Profiling to achieve smooth, accurate movement."
    },
    {
      "type": "rules-box",
      "title": "Goals",
      "subtitle": "The elevator subsystem must:",
      "items": [
        "Move to setpoints (Low, Mid, High).",
        "Hold position (Brake Mode + PID).",
        "Use Motion Profiling (Smooth acceleration).",
        "Compensate for gravity (Feedforward)."
      ]
    },
    {
      "type": "code-tabs",
      "title": "Subsystem Code",
      "content": "Implementation with PID + Feedforward:",
      "tabs": [
        {
          "label": "Talon FX",
          "code": "package frc.robot.subsystems;\n\nimport edu.wpi.first.wpilibj2.command.SubsystemBase;\nimport com.ctre.phoenix6.hardware.TalonFX;\nimport com.ctre.phoenix6.configs.TalonFXConfiguration;\nimport com.ctre.phoenix6.signals.NeutralModeValue;\nimport com.ctre.phoenix6.controls.MotionMagicVoltage;\n\npublic class Elevator extends SubsystemBase {\n    // Elevator motor on CAN ID 6\n    private final TalonFX m_motor = new TalonFX(6);\n    \n    // Motion Magic control request (trapezoidal motion profile)\n    private final MotionMagicVoltage m_request = new MotionMagicVoltage(0);\n\n    public Elevator() {\n        TalonFXConfiguration config = new TalonFXConfiguration();\n        // Brake mode to hold position against gravity\n        config.MotorOutput.NeutralMode = NeutralModeValue.Brake;\n        \n        // PID gains for position control (Slot 0)\n        config.Slot0.kP = 0.5;  // Proportional gain\n        config.Slot0.kI = 0.0;  // Integral gain\n        config.Slot0.kD = 0.05; // Derivative gain\n        config.Slot0.kG = 0.12; // Gravity feedforward (compensates for weight)\n        config.Slot0.kS = 0.05; // Static friction feedforward\n        \n        // Motion profile constraints\n        config.MotionMagic.MotionMagicCruiseVelocity = 10; // Max velocity (rotations/sec)\n        config.MotionMagic.MotionMagicAcceleration = 20;   // Max acceleration (rotations/secÂ²)\n        \n        m_motor.getConfigurator().apply(config);\n    }\n    \n    /**\n     * Set elevator to target height\n     * @param rotations Target position in rotations\n     */\n    public void setHeight(double rotations) {\n        m_motor.setControl(m_request.withPosition(rotations));\n    }\n}"
        },
        {
          "label": "SPARK MAX",
          "code": "package frc.robot.subsystems;\n\nimport edu.wpi.first.wpilibj2.command.SubsystemBase;\nimport com.revrobotics.spark.SparkMax;\nimport com.revrobotics.spark.SparkLowLevel.MotorType;\nimport com.revrobotics.spark.config.SparkMaxConfig;\nimport com.revrobotics.spark.config.SparkBaseConfig.IdleMode;\nimport com.revrobotics.spark.SparkBase.ResetMode;\nimport com.revrobotics.spark.SparkBase.PersistMode;\nimport com.revrobotics.spark.ClosedLoopController.ControlType;\n\npublic class Elevator extends SubsystemBase {\n    // Elevator motor on CAN ID 6, brushless type\n    private final SparkMax m_motor = new SparkMax(6, MotorType.kBrushless);\n    // Get closed-loop controller for PID control\n    private final SparkClosedLoopController m_pid = m_motor.getClosedLoopController();\n    \n    public Elevator() {\n        SparkMaxConfig config = new SparkMaxConfig();\n        // Brake mode to hold position against gravity\n        config.idleMode(IdleMode.kBrake);\n        \n        // PID gains for position control\n        config.closedLoop.p(0.5).i(0.0).d(0.05);\n        // Motion profile constraints (MAXMotion = trapezoidal profile)\n        config.closedLoop.maxMotion.maxVelocity(3000).maxAcceleration(2000);\n        \n        m_motor.configure(config, ResetMode.kResetSafeParameters, PersistMode.kPersistParameters);\n    }\n    \n    /**\n     * Set elevator to target height\n     * @param rotations Target position in rotations\n     */\n    public void setHeight(double rotations) {\n        m_pid.setReference(rotations, ControlType.kMAXMotionPositionControl);\n    }\n}"
        }
      ]
    },
    {
      "type": "text",
      "title": "Commands",
      "content": "Use simple commands to set targets."
    },
    {
      "type": "code",
      "title": "RobotContainer",
      "content": "// ... (in RobotContainer class)\n\nimport edu.wpi.first.wpilibj2.command.Commands;\nimport edu.wpi.first.wpilibj2.command.button.CommandXboxController;\nimport frc.robot.subsystems.Elevator;\n\n// ... (other fields)\n\npublic RobotContainer() {\n    // ... (other initialization)\n    \n    // Button A: Move to low position (0 rotations)\n    m_controller.a().onTrue(Commands.runOnce(() -> m_elevator.setHeight(0.0), m_elevator));\n    // Button B: Move to high position (10 rotations)\n    m_controller.b().onTrue(Commands.runOnce(() -> m_elevator.setHeight(10.0), m_elevator));\n    \n    // ... (rest of constructor)\n}"
    },
    {
      "type": "rules-box",
      "title": "Tuning Tips",
      "subtitle": "Order of operations:",
      "items": [
        "<strong>Gravity (kG):</strong> Increase until elevator holds position or falls very slowly (open loop).",
        "<strong>Proportional (kP):</strong> Increase until it reaches target reasonably well.",
        "<strong>Derivative (kD):</strong> Add to stop oscillation/overshoot.",
        "<strong>Profile:</strong> Adjust Max Velocity/Acceleration for speed vs smoothness."
      ]
    },
    {
      "type": "link-grid",
      "title": "Related",
      "links": [
        {
          "label": "PID Control",
          "id": "pid-control"
        },
        {
          "label": "Motion Profiling",
          "id": "motor-motion-profiling"
        }
      ]
    }
  ]
}
